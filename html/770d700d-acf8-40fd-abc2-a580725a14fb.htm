<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-zh-CN.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>组合子属性</title><meta name="Language" content="zh-cn" /><meta name="Microsoft.Help.Id" content="770d700d-acf8-40fd-abc2-a580725a14fb" /><meta name="Description" content="领域实体的关系中，只有引用、组合两种关系。组合关系，又称为父子关系，在领域模型的设计中，是非常重要的。它对应 DDD 中的聚合关系，对应 UML 中的组合关系。它表示一种包含关系，一旦父对象消亡，所有的子对象也同时消亡。例如：一张表单与它的明细项之间的关系，就是一种组合父子关系。一张表单一旦被删除，与它关联的所有明细项也同时没有意义，必须被删除。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Rafy User Guide<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="69b641cf-d1fe-4f06-877f-b479d268a3fc.htm" title="Rafy User Guide" tocid="roottoc">Rafy User Guide</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="69b641cf-d1fe-4f06-877f-b479d268a3fc.htm" title="Rafy框架" tocid="69b641cf-d1fe-4f06-877f-b479d268a3fc">Rafy框架</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c8e6cd25-c674-4cd1-9880-816d11f58eb8.htm" title="领域实体框架" tocid="c8e6cd25-c674-4cd1-9880-816d11f58eb8">领域实体框架</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="e9998e68-31e8-47d6-9e28-829aade5044e.htm" title="领域实体" tocid="e9998e68-31e8-47d6-9e28-829aade5044e">领域实体</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="8c0065bc-f165-4c69-81f4-9c3c57bd9ab9.htm" title="实体属性" tocid="8c0065bc-f165-4c69-81f4-9c3c57bd9ab9">实体属性</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="3ad175ff-a917-4e84-931f-f845285187ed.htm" title="一般属性" tocid="3ad175ff-a917-4e84-931f-f845285187ed">一般属性</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="bae4aeb4-e6a9-4d1f-9bbd-1a4199303ba5.htm" title="引用属性" tocid="bae4aeb4-e6a9-4d1f-9bbd-1a4199303ba5">引用属性</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="770d700d-acf8-40fd-abc2-a580725a14fb.htm" title="组合子属性" tocid="770d700d-acf8-40fd-abc2-a580725a14fb">组合子属性</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0eaa08ea-b1fc-42c6-8d48-2ed176b945c1.htm" title="冗余属性" tocid="0eaa08ea-b1fc-42c6-8d48-2ed176b945c1">冗余属性</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8120fc14-ef61-43cd-99a5-21c6edd5d38b.htm" title="大数据属性" tocid="8120fc14-ef61-43cd-99a5-21c6edd5d38b">大数据属性</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="711304c2-d2a3-4ec9-abd8-00edd86fb3ca.htm" title="只读属性" tocid="711304c2-d2a3-4ec9-abd8-00edd86fb3ca">只读属性</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="点击或拖拽改变大小" title="点击或拖拽改变大小" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="点击或拖拽改变大小" title="点击或拖拽改变大小" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>组合子属性</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>本页包含以下内容：</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#compoRelation">组合关系</a></li><li class="outlineSectionEntry"><a href="#code">示例</a></li><li class="outlineSectionEntry"><a href="#lazy">懒加载</a></li></ul></div><div class="collapsibleAreaRegion" id="compoRelation"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />组合关系</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
                    领域实体的关系中，只有引用、组合两种关系。组合关系，又称为父子关系，在领域模型的设计中，是非常重要的。它对应 DDD 中的聚合关系，对应 UML 中的组合关系。它表示一种包含关系，一旦父对象消亡，所有的子对象也同时消亡。例如：一张表单与它的明细项之间的关系，就是一种组合父子关系。一张表单一旦被删除，与它关联的所有明细项也同时没有意义，必须被删除。
                </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="备注" /> <b>备注：</b></th></tr><tr><td><p>
                        另外，两个类之间的关系，并不一定是固定的，需要根据领域而变化。例如车和车轮，对于一般的系统而言，它们是一个整体，应该设计为组合关系；但是如果领域是车辆制造管理，那么车轮就没必要设计为车辆的组合子实体了。
                    </p></td></tr></table></div></div><div class="collapsibleAreaRegion" id="code"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />示例</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
                    组合关系在代码实现时，需要同时声明两个属性：在组合父实体类型中声明一个组合子属性，属性的类型为组合子实体对应的集合类型；同时还需要在组合子实体类型中声明一个组合父引用属性，属性的类型为组合父实体类型。（组合父引用属性，参见：<a href="bae4aeb4-e6a9-4d1f-9bbd-1a4199303ba5.htm">引用属性</a>。）
                </p><p>
                    以下代码为 Car （车辆）类声明了一个名称为 WheelList 的组合子属性，该属性类型为 WheelList，表示一个车轮的集合。
                </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAAACAAA_tab1" class="codeSnippetContainerTabSingle">属性声明示例</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAAACAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAAACAAA');return false;" title="复制">复制</a></div></div><div id="ID1EAAACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">static</span> <span class="highlight-keyword">readonly</span> ListProperty&lt;WheelList&gt; WheelListProperty = P&lt;Car&gt;.RegisterList(e =&gt; e.WheelList);
<span class="highlight-keyword">public</span> WheelList WheelList
{
    <span class="highlight-keyword">get</span> { <span class="highlight-keyword">return</span> <span class="highlight-keyword">this</span>.GetLazyList(WheelListProperty); }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAAACAAA");</script></div><div class="collapsibleAreaRegion" id="lazy"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />懒加载</span></div><div id="ID3RBSection" class="collapsibleSection"><p>组合子属性的值是被设计为懒加载的。在获取属性的值时，如果实体集合还没有加载，则框架会根据当前实体的 Id 值，从组合子实体的仓库中中查询出所有的子实体，并装载为一个实体集合。</p><p>调用仓库的方法是 GetByParentId。</p></div></div></div><div id="pageFooter" class="pageFooter">有问题请联系 9474649@qq.com。<div class="feedbackLink">有关这个主题的评论请发邮件到
        <a id="HT_MailLink" href="mailto:9474649%40qq.com?Subject=Rafy User Guide">发送反馈</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>