<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-zh-CN.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>RBAC 插件</title><meta name="Language" content="zh-cn" /><meta name="Microsoft.Help.Id" content="c4919121-bad5-4b1d-b3c2-6a889590af53" /><meta name="Description" content="Rafy基于角色的访问权限控制,主要包含四个插件，角色插件（Rafy.RBAC.RoleManagement）、用户角色插件（Rafy.RBAC.UserRoleManagement）、组织插件（Rafy.RBAC.GroupManagement）、数据权限插件（Rafy.RBAC." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Rafy User Guide<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="69b641cf-d1fe-4f06-877f-b479d268a3fc.htm" title="Rafy User Guide" tocid="roottoc">Rafy User Guide</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="69b641cf-d1fe-4f06-877f-b479d268a3fc.htm" title="Rafy框架" tocid="69b641cf-d1fe-4f06-877f-b479d268a3fc">Rafy框架</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2a81b03d-24b4-4463-9e57-34cbaa105adf.htm" title="现有插件" tocid="2a81b03d-24b4-4463-9e57-34cbaa105adf">现有插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f662f88a-8221-49f4-bc38-901134ea893e.htm" title="幽灵插件" tocid="f662f88a-8221-49f4-bc38-901134ea893e">幽灵插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="1ce3c19a-3de6-4956-afd0-a7fc6e577768.htm" title="流水号插件" tocid="1ce3c19a-3de6-4956-afd0-a7fc6e577768">流水号插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="e13240fe-3c80-47e1-9645-f154e8b72a83.htm" title="时间戳插件" tocid="e13240fe-3c80-47e1-9645-f154e8b72a83">时间戳插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="507d98b9-f88c-48bf-a12b-dded5e021340.htm" title="帐户插件" tocid="507d98b9-f88c-48bf-a12b-dded5e021340">帐户插件</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="c4919121-bad5-4b1d-b3c2-6a889590af53.htm" title="RBAC 插件" tocid="c4919121-bad5-4b1d-b3c2-6a889590af53">RBAC 插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="5554eab4-a79f-473c-ac64-d028e7e39145.htm" title="多国语言插件" tocid="5554eab4-a79f-473c-ac64-d028e7e39145">多国语言插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="064b28a9-25ac-49f1-a964-56bbea3fac89.htm" title="附件插件" tocid="064b28a9-25ac-49f1-a964-56bbea3fac89">附件插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="87a44564-2ce0-4065-8174-ce612bc1583b.htm" title="大批量导入实体插件" tocid="87a44564-2ce0-4065-8174-ce612bc1583b">大批量导入实体插件</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d862044a-9278-47cc-857e-3ccbdd3d3ed6.htm" title="文件存储插件" tocid="d862044a-9278-47cc-857e-3ccbdd3d3ed6">文件存储插件</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="点击或拖拽改变大小" title="点击或拖拽改变大小" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="点击或拖拽改变大小" title="点击或拖拽改变大小" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>RBAC 插件</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>
        Rafy基于角色的访问权限控制,主要包含四个插件，角色插件（Rafy.RBAC.RoleManagement）、用户角色插件（Rafy.RBAC.UserRoleManagement）、组织插件（Rafy.RBAC.GroupManagement）、数据权限插件（Rafy.RBAC.DataPermissionManagement）。其中角色插件是底层插件，其它三个插件都依赖角色插件，如下图。四个插件可以组合也可以独立使用，用户根据自己的实际场景自行下载相应的插件。
        <p>
        权限管理技术，一般使用基于角色访问控制技术RBAC（Role Based Access Control）。该技术被广泛运用于各个系统，非常容易掌握。该技术模型如下图示：
        <div class="mediaNear"><img alt="RBAC权限模型" src="../media/RBAC权限模型.png" /></div></p><div class="mediaNear"><img alt="RBAC 05" src="../media/RBAC05.png" /></div></p><p>用户可以通过 Nuget Package Manager 搜索rafy.rbac并选择安装相应的插件。</p><div class="mediaNear"><img alt="RBAC插件01" src="../media/RBAC插件01.png" /></div><p>本页包含以下内容：</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#senarios">角色插件（Rafy.RBAC.RoleManagement）</a></li><li class="outlineSectionEntry"><a href="#senarios">用户角色插件（Rafy.RBAC.UserRoleManagement）</a></li><li class="outlineSectionEntry"><a href="#senarios">组织插件（Rafy.RBAC.GroupManagement）</a></li><li class="outlineSectionEntry"><a href="#senarios">数据权限插件（Rafy.RBAC.DataPermissionManagement）</a></li><li class="outlineSectionEntry"><a href="#senarios">插件使用</a></li></ul></div><div class="collapsibleAreaRegion" id="senarios"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />角色插件（Rafy.RBAC.RoleManagement）</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
          领域关系图如下：
          <div class="mediaNear"><img alt="RBAC 01" src="../media/RBAC01.png" /></div></p><p>
          该插件主要包含角色和资源，每个资源包含多个功能操作，功能操作和角色进行关联。通过角色来控制功能权限。当系统只需要角色及功能权限时，可以选择此插件。
        </p></div><div class="collapsibleAreaRegion" id="senarios"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />用户角色插件（Rafy.RBAC.UserRoleManagement）</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
          领域关系图如下：
          <div class="mediaNear"><img alt="RBAC 02" src="../media/RBAC02.png" /></div></p><p>
          该插件依赖账户插件（Rafy.Accounts）,和角色插件（Rafy.RBAC.RoleManagement），主要包含用户和角色的关系，一个用户可以有多个角色。如果系统启用用户和角色关联可以采用此插件。
        </p></div><div class="collapsibleAreaRegion" id="senarios"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />组织插件（Rafy.RBAC.GroupManagement）</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
          领域关系图如下：
          <div class="mediaNear"><img alt="RBAC 03" src="../media/RBAC03.png" /></div></p><p>
          该插件依赖账户插件（Rafy.Accounts）,和角色插件（Rafy.RBAC.RoleManagement），主要包含组织，组织和角色关系，组织和用户关系，一个组织可以包含多个用户，同时也可以有多个角色。当系统有组织模型时，可以选择此插件。
        </p></div><div class="collapsibleAreaRegion" id="senarios"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />数据权限插件（Rafy.RBAC.DataPermissionManagement）</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
          领域关系图如下：
          <div class="mediaNear"><img alt="RBAC 04" src="../media/RBAC04.png" /></div></p><p>
          该插件依赖角色插件（Rafy.RBAC.RoleManagement），主要是对某个资源进行数据过滤。数据过滤类型提供两种。一种是基于用户进行过滤，一种是基于组织（及其下级组织）进行过滤。同时支持扩展，需要自己实现DataPermissionConstraintBuilder类。当系统提供数据权限时可以选择此插件。
        </p></div><div class="collapsibleAreaRegion" id="senarios"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />插件使用</span></div><div id="ID5RBSection" class="collapsibleSection"><p>在 DomainApp 中添加需要的插件：</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID4EAAAEAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID4EAAAEAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID4EAAAEAAA');return false;" title="复制">复制</a></div></div><div id="ID4EAAAEAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">class</span> JXCApp : DomainApp
{
    <span class="highlight-keyword">protected</span> <span class="highlight-keyword">override</span> <span class="highlight-keyword">void</span> InitEnvironment()
    {
        <span class="highlight-comment">//添加RBAC插件到 Rafy 应用程序集中。</span>
         RafyEnvironment.DomainPlugins.Add(<span class="highlight-keyword">new</span> AccountsPlugin());
         RafyEnvironment.DomainPlugins.Add(<span class="highlight-keyword">new</span> RoleManagementPlugin());
         RafyEnvironment.DomainPlugins.Add(<span class="highlight-keyword">new</span> GroupManagementPlugin());
         RafyEnvironment.DomainPlugins.Add(<span class="highlight-keyword">new</span> UserRoleManagementPlugin());
         RafyEnvironment.DomainPlugins.Add(<span class="highlight-keyword">new</span> DataPermissionManagementPlugin());

        <span class="highlight-keyword">base</span>.InitEnvironment();
    }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID4EAAAEAAA");</script></div></div></div><div id="pageFooter" class="pageFooter">有问题请联系 9474649@qq.com。<div class="feedbackLink">有关这个主题的评论请发邮件到
        <a id="HT_MailLink" href="mailto:9474649%40qq.com?Subject=Rafy User Guide">发送反馈</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>